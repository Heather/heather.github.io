---
title: Boost Application Interprocess with Qt Quick
---

Here is template in current stage on [GitHub](https://github.com/Heather/Perfume)
---------------------------------------------

<img align="right" src="http://www.eisenberg.com/media/product/2ef/j-ose-by-eisenberg-paris-9b5.png">

 - Boost Application runs as Service on Windows, as Daemon on Linux, can self install / uninstall / run from console
 - Plugin system support via Boost.DLL
 - Modern CMAKE system for crossIDE building
 - log4cpp as modern logging system for C++
 - Qt5 QtQuick Application with Tray icon as GUI part
 - Boost interprocess for sharing memory between them

How to build:
-------------

``` shell
cmake ../Perfume
```

Notes:
======

 - boost build example `b2 toolset="msvc" --build-type=complete stage`
 - for git [boost](https://github.com/boostorg/boost) version also pass `--without-context --without-coroutine` to `b2`
 - also with some reason general includes alike asio with git boost located in `libs/asio/includes` folder (maybe it's done for reason) so for now CMake adds those paths to includes
 - It's possible to run QtQuick application from Visual Studio, to do it you must add path to Qt5 bin (where dlls located) to it's environment.
 - for 64 build use something alike: `cmake ../Perfume -G"Visual Studio 11 Win64"`

Server
======

<img align="left" src="http://cdn.flaticon.com/png/256/30983.png">

``` cpp
LOG4CPLUS_INFO(logger_, "Running server class");
managed_shared_memory segment
   (create_only, "Patchouli", 65536);

managed_shared_memory::size_type free_memory = 
                         segment.get_free_memory();

void * shptr = segment.allocate(1024);
segment.construct<sharedString>( "sharedString" )
        (app_name, segment.get_segment_manager());

boost::thread thread(&server::worker, this);
```

Client
======

<img align="right" src="http://cdn.flaticon.com/png/256/33804.png">

``` cpp
root->connect(trayIcon, &QSystemTrayIcon::activated,
  [root] (QSystemTrayIcon::ActivationReason reason) {
    switch (reason) {
    case QSystemTrayIcon::Trigger:
    case QSystemTrayIcon::DoubleClick:
      ((QQuickWindow *)root)->showNormal();
      break;
    }
});
managed_shared_memory segment(open_only, "Patchouli");
std::pair<sharedString * , size_t > p
  = segment.find<sharedString>("sharedString");
((QQuickWindow *)root)->setTitle( p.first->c_str() );
```

Credits
=======

 - based on https://github.com/snikulov/boost.app.cmake
