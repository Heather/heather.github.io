<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html ng-app>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        
        <title>Heather - hsjsmin JavaScript minifier for Hakyll</title>
        <meta name="description" content="Heather">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <link href="../atom.xml" rel="alternate" title="Heather" type="application/atom+xml">
        <link rel="shortcut icon" type="image/ico" href="../favicon.ico" />

        <script src="../bootstrap/jquery-2.1.1.min.js"></script>
        <link rel="stylesheet" href="../bootstrap/bootstrap.min.css">
        <script src="../bootstrap/bootstrap.min.js"></script>
        <script src="../bootstrap/angular.min.js"></script>
        
        <link rel="stylesheet" type="text/css" media="all" href="../css/hasklig.css">
        <link rel="stylesheet" type="text/css" media="all" href="../css/octicons.css">
        <link rel="stylesheet" type="text/css" media="all" href="../css/syntax.css" />
        <link rel="stylesheet" type="text/css" media="all" href="../clay/default.css" />
        
        <script type="application/javascript" src="../js/auto.js"></script>
    </head>
    <body>
        <div class="band"></div>
        <div id="header">
            <div id="logo">
                <a id="abbr" href="../"></a>
                <script>
                    e = document.getElementById("abbr");
                    setTimeout(r, 0);
                </script>
            </div>
        </div>
        <div id="content">
            <h1>hsjsmin JavaScript minifier for Hakyll</h1>

<audio id="audio" autoplay>
    <source src="http://dl.zaycev.net/76134/10101/nirvana_-_lithium_(zaycev.net).mp3" type="audio/mp3"></source>
</audio>

<div class="info">Posted on 30 October 2014</div>

<p>I discovered that by default Hakyll only can <code>compressCssCompiler</code> and there is no <code>compressJsCompiler</code></p>
<p>So Iâ€™ve found <a href="https://github.com/alanz/hjsmin/blob/master/Text/Jasmine.hs">hsjsmin</a> for this task</p>
<h2 id="include">Include</h2>
<pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">import </span><span class="dt">Control.Applicative</span> ((&lt;$&gt;))

<span class="kw">import qualified</span> <span class="dt">Data.ByteString.Lazy</span> <span class="kw">as</span> <span class="dt">LB</span>
<span class="kw">import qualified</span> <span class="dt">Data.Text</span> <span class="kw">as</span> <span class="dt">T</span>
<span class="kw">import qualified</span> <span class="dt">Data.Text.Encoding</span> <span class="kw">as</span> <span class="dt">E</span>

<span class="kw">import </span><span class="dt">Text.Jasmine</span></code></pre>
<h2 id="apply">Apply</h2>
<pre class="sourceCode haskell"><code class="sourceCode haskell">match <span class="st">&quot;js/*&quot;</span> <span class="fu">$</span> <span class="kw">do</span>
    route idRoute
    compile compressJsCompiler</code></pre>
<h2 id="implement">Implement</h2>
<pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">compressJsCompiler ::</span> <span class="dt">Compiler</span> (<span class="dt">Item</span> <span class="dt">String</span>)
compressJsCompiler <span class="fu">=</span> fmap compressCss <span class="fu">&lt;$&gt;</span> getResourceString

<span class="ot">jasmin ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span>
jasmin src <span class="fu">=</span> show <span class="fu">$</span> minify <span class="fu">$</span> LB.fromChunks [(E.encodeUtf8 <span class="fu">$</span> T.pack src)] </code></pre>
<p>It works pretty fine so I even think this should be somewhere in hakyll docs</p>

<hr />

        </div>
        
        <div id="social">
            <ul>
              <li>
                <a href="http://github.com/Heather" title="Github" target="_blank">
                  <span class="mega-octicon octicon-octoface"></span>
                </a>
              </li>
              <li>
                <a href="http://twitter.com/Cynede" title="Twitter" target="_blank">
                  <span class="mega-octicon octicon-star"></span>
                </a>
              </li>
              <li>
                <a href="mailto:heather@live.ru" title="Main mail" target="_blank">
                  <span class="mega-octicon octicon-mail-read"></span>
                </a>
              </li>
              <li>
                <a href="http://www.last.fm/user/Cynede" title="Last.fm" target="_blank">
                  <span class="mega-octicon octicon-broadcast"></span>
                </a>
              </li>
              <li>
                <a href="http://grooveshark.com/#!/cynede" title="Grooveshark" target="_blank">
                  <span class="mega-octicon octicon-squirrel"></span>
                </a>
              </li>
              <li>
                <a href="../atom.xml" title="RSS" target="_blank">
                  <span class="mega-octicon octicon-rss"></span>
                </a>
              </li>
            </ul>
        </div>
        
        <div id="footer">

        </div>

    <script type="application/javascript" src="../web/packages/browser/dart.js"></script>
    </body>
</html>
