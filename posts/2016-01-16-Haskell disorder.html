<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE html><html ng-app><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="description" content="Heather"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link title="Heather" type="application/atom+xml" rel="alternate" href="../atom.xml"><link type="image/ico" rel="shortcut icon" href="../favicon.ico"><script src="../bootstrap/jquery-2.1.1.min.js"></script><link rel="stylesheet" href="../bootstrap/bootstrap.min.css"><link rel="stylesheet" href="../bootstrap/bootstrap-theme.min.css"><script src="../bootstrap/bootstrap.min.js"></script><script src="../bootstrap/angular.min.js"></script><link media="all" type="text/css" rel="stylesheet" href="../css/hasklig.css"><link media="all" type="text/css" rel="stylesheet" href="../css/octicons.css"><link media="all" type="text/css" rel="stylesheet" href="../css/syntax.css"><link media="all" type="text/css" rel="stylesheet" href="../css/default.css"><title>Heather - Haskell disorder</title><script src="../js/auto.js"></script></head><body><div class="band"></div><div id="header"><div id="logo"><a id="abbr" href="../"></a><script>e = document.getElementById("abbr");setTimeout(r, 0);</script></div></div><div id="content"><h1>Haskell disorder</h1><audio loop id="audio" autoplay><source src="../images/Bween.mp3" type="audio/mp3"></audio><div id="controls"><img src="../images/RedPause.png" id="playpause" height="20px" width="20px"></div><div class="info">Posted on 16 January 2016</div><h1 id="sandbox-all-the-things">Sandbox all the things!</h1>
<p>For example we can use <code>A &gt; 2</code> for library <code>B</code> and <code>A &lt; 2</code> for library <code>C</code> so we do but we can’t use libraries <code>B</code> and <code>C</code> together. It will be a problem for someone who want to use <code>B</code> and <code>C</code> but not a problem at all for either <code>B</code> and <code>C</code> developers. Because we have so much cool tools: lovely stack and cabal sandboxes which allow us to use <code>B</code> for application <code>X</code> and <code>C</code> for application <code>Y</code> together but sandboxed. Most horrible thing there is that most of Haskell developers really don’t see reason to support another <code>A</code> versions.</p>
<p>Another horrible thing there is when developers don’t bump <code>A</code> just because they are lazy to test and don’t need it. If you think that’s not the case you can check how often we bump max limits with <code>cabal_chdeps</code> calls in <code>gentoo-haskell</code> ebuilds.</p>
<p>All those <code>distro-patches</code> and weak <code>distro-hacks</code> used in Gentoo for haskell makes <code>portage</code> the only one existing package manager for haskell. I’m not sure if Nix people have any progress in this direction honestly. I don’t see how Stackage can do the same. With portage you can use Haskell without sandboxes and without breaking everything, YES YOU CAN. NOTHING IS IMPOSSIBLE. But community don’t need it. Most of haskell developers I was speaking with JUST DON’T CARE about compatibility and even see no real problems.</p>
<p>I don’t know why but people don’t understand my reasoning, everywhere people tell me that I just don’t understand stack…</p>
<p>Another horrible hacks are packages provided by GHC (alike transformers) and hacks packages with <code>-compat</code>. I don’t even know honestly why it’s there but if some package needs <code>tranformers</code> upper then in GHC it just break everything else if you’re not in sandbox.</p>
<p>next day to write some Hello World in Haskell you will need to buy PC supporting building Hello World in Haskell, install Hello World Building OS, Create Hello World sandbox with HelloWorld compiler, patch Hello World library to support Hello World compiler from your “LTS” but sure we have all the tools to make it simple! we’re so much proud about them… with stack we can have Hello World compiler installed once for user so we can build many Hello World applications alike that using this same compiler. I know, awesome…</p>
<p>But where we go? There was no package manager for haskell for many years <a href="https://ivanmiljenovic.wordpress.com/2010/03/15/repeat-after-me-cabal-is-not-a-package-manager/">Cabal is not a Package Manager</a> and now there is stack which is doing the same but only a bit better, that’s why I don’t like stack. I was hoping for radical changes but there is just a bit more handy util to produce same problems again, not to resolve but to avoid.</p>
<p>Look at this function is one of core packages in Setup.lhs:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">testDeps ::</span> <span class="dt">ComponentLocalBuildInfo</span> <span class="ot">-&gt;</span> <span class="dt">ComponentLocalBuildInfo</span> <span class="ot">-&gt;</span> [(<span class="dt">InstalledPackageId</span>, <span class="dt">PackageId</span>)]
testDeps xs ys <span class="fu">=</span> nub <span class="fu">$</span> componentPackageDeps xs <span class="fu">++</span> componentPackageDeps ys</code></pre></div>
<p>It doesn’t work because <code>InstalledPackageId</code> is changed to <code>UnitId</code> in new cabal but you can’t fix it. Ideally maybe you can</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="st">#if MIN_VERSION_Cabal(1, 23, 0)</span>
<span class="ot">testDeps ::</span> <span class="dt">ComponentLocalBuildInfo</span> <span class="ot">-&gt;</span> <span class="dt">ComponentLocalBuildInfo</span> <span class="ot">-&gt;</span> [(<span class="dt">UnitId</span>, <span class="dt">PackageId</span>)]
<span class="st">#else</span>
<span class="ot">testDeps ::</span> <span class="dt">ComponentLocalBuildInfo</span> <span class="ot">-&gt;</span> <span class="dt">ComponentLocalBuildInfo</span> <span class="ot">-&gt;</span> [(<span class="dt">InstalledPackageId</span>, <span class="dt">PackageId</span>)]
<span class="st">#endif</span></code></pre></div>
<p>but because it’s Setup.lhs you can’t use <code>MIN_VERSION_Cabal</code> MIN_VERSION_Cabal is a macro from cabal_macros.h that is generated by Setup.lhs so you pick either people with old cabal will always fail or people with new cabal will always fail, such stuff are all around haskell</p>
<p>In conclusion this problem is known outside haskell. Often some C++ projects shipping with patched Qt or Boost whenever you have it installed you build and install those monsters in addition to existing and then suffer from possible conflicts. This scheme often used for production, enterprise software, however most of opensource ecosystem don’t act like that. In haskell community people act like they’re always alike in production / enterprise and that’s what I can’t understand, when sandbox became something mandatory?</p>
<h1 id="do-you-even-know-what-is-induction">Do you even know what is induction?</h1>
<p>Yes, Haskell is very hard and maybe I just don’t understand anything</p>
<iframe width="420" height="315" src="http://www.youtube.com/embed/v93rM8-bU2g?autoplay=1">
</iframe><div id="postfooter"></div><script src="../js/playpause.js"></script><script src="../bootstrap/three.js"></script><script src="../js/bubbles.js"></script></div><div id="social"><ul><li><a title="Github" target="_blank" href="http://github.com/Heather"><span class="mega-octicon octicon-octoface"></span></a></li><li><a title="Twitter" target="_blank" href="http://twitter.com/Cynede"><span class="mega-octicon octicon-star"></span></a></li><li><a title="mail" target="_blank" href="mailto:heather@live.ru"><span class="mega-octicon octicon-mail-read"></span></a></li><li><a title="Last.fm" target="_blank" href="http://www.last.fm/user/Cynede"><span class="mega-octicon octicon-broadcast"></span></a></li><li><a title="Stackoverflow" target="_blank" href="http://stackoverflow.com/users/238232/heather"><span class="mega-octicon octicon-squirrel"></span></a></li><li><a title="RSS" target="_blank" href="../atom.xml"><span class="mega-octicon octicon-rss"></span></a></li></ul></div><div id="footer"></div></body></html>